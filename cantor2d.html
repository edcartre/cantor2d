<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
  <title>D3::Cantor 2D</title>
  <link href="estilo.css" media="all" rel="stylesheet" type="text/css" />
  </head>

  <body>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<div class="header">
<h1>D3::Cantor 2D</h1>
</div>

<div class="content">

<div id='c2d' class="vis"></div>

<!--  ----------------------------------------------------------- -->

<script>

var WIDTH = 600;
var HEIGHT = WIDTH/2;
var MAXLEVEL = 4;


function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}



var esc = d3.scale.linear()
    .range([0, HEIGHT]);




var semilla = d3.range(9).map(function() {return Math.round(Math.random());});

console.log(semilla)

var cuadros = [];

function gencuadros(sem, nivel, ind, x0, y0, tam) {

    cuadros.push({"nivel":nivel, "ind":ind, "x0":x0, "y0":y0, "tam":tam});
    //console.log(nivel)
    if (nivel >= MAXLEVEL) {return;}

    var nnivel = nivel + 1;
    var ntam = tam / 3;

    if (sem[0]==1) {gencuadros(sem, nnivel, 0, x0+0*ntam, y0+0*ntam, ntam)}
    if (sem[1]==1) {gencuadros(sem, nnivel, 1, x0+1*ntam, y0+0*ntam, ntam)}
    if (sem[2]==1) {gencuadros(sem, nnivel, 2, x0+2*ntam, y0+0*ntam, ntam)}
    if (sem[3]==1) {gencuadros(sem, nnivel, 3, x0+0*ntam, y0+1*ntam, ntam)}
    if (sem[4]==1) {gencuadros(sem, nnivel, 4, x0+1*ntam, y0+1*ntam, ntam)}
    if (sem[5]==1) {gencuadros(sem, nnivel, 5, x0+2*ntam, y0+1*ntam, ntam)}
    if (sem[6]==1) {gencuadros(sem, nnivel, 6, x0+0*ntam, y0+2*ntam, ntam)}
    if (sem[7]==1) {gencuadros(sem, nnivel, 7, x0+1*ntam, y0+2*ntam, ntam)}
    if (sem[8]==1) {gencuadros(sem, nnivel, 8, x0+2*ntam, y0+2*ntam, ntam)}


}

gencuadros(semilla, 0, 0, 0, 0, 1)

console.log(cuadros)




var esccoln = d3.scale.linear()
    .domain([0, MAXLEVEL])
    .range([0, 360]);


var esccol = d3.scale.linear()
    .domain([0, cuadros.length])
    .range([0, 360]);

d3.select('#c2d').append( "text")
    .attr({
        'text-anchor'   : 'middle',
        y               : 10
    })
    .text(cuadros.length + " objetos")
;

var svg = d3.select('#c2d').append('svg')
    .attr({
      'width': WIDTH,
      'height': HEIGHT,
    });

var frac = svg.selectAll('rect.frac')
    .data(cuadros)
  .enter().append('rect')
    .attr("class", "frac")
    //.attr("width", 1)
    //.attr("height", 1)
.style("fill", function(d,i) { return "hsl(" + Math.random()*360 + ",70%,50%,50%)"; })
    .attr("x", function() {return WIDTH*(Math.random());})
    .attr("y", function() {return HEIGHT*(Math.random());})
    .attr("x", function(d,i) { return esc(d.x0);})
    .attr("y", function(d,i) { return esc(d.y0);})
    .transition()
    .attr("height", function(d,i) { return esc(d.tam);})
    .attr("width", function(d,i) { return esc(d.tam);})
    .style("fill", function(d,i) { return "hsl(" + Math.random()*360 + ",70%,50%,50%)"; })
    //.attr("opacity", "1")
    .duration(3000)
    .delay(function(d, i) { return i / cuadros.length * 3000; })
;


</script>

</content>
</body>
</html>
